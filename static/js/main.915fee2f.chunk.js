(this["webpackJsonpmap-chatr"]=this["webpackJsonpmap-chatr"]||[]).push([[0],{100:function(e,t,a){},105:function(e,t,a){},114:function(e,t,a){},130:function(e,t,a){},134:function(e,t,a){"use strict";a.r(t);var s=a(1),c=a(0),n=a.n(c),o=a(14),r=a.n(o),i=(a(80),a(19)),l=a(3),j=a(64),u=a.n(j),h=a(26),d=a.n(h),b=d.a.create({baseURL:"http://localhost:9000"}),m=(a(99),a(65)),g=a.n(m),f=a(66),O=a.n(f),x=a(40),p=a.n(x),v=a(67),S=a.n(v),M=a(154),N=a(153),C=(a(100),function(e){var t=Object(c.useState)(""),a=Object(l.a)(t,2),n=a[0],o=a[1];Object(c.useEffect)((function(){e.room.lastMessage.length<=15?o(e.room.lastMessage):o(e.room.lastMessage.substring(0,20)+" ...")}),[e.room.lastMessage]),Object(c.useEffect)((function(){e.roomName===e.room.name&&""!==e.lastMessage&&(e.lastMessage.length<=15?o(e.lastMessage):o(e.lastMessage.substring(0,20)+"..."))}),[e.lastMessage]);return Object(s.jsxs)("div",{className:"sidebarChat",onClick:function(){e.handleClick(e.room.name),!0!==e.toggleChatStatus&&e.toggleChat()},children:[Object(s.jsx)(M.a,{}),Object(s.jsxs)("div",{className:"sidebarChat_info",children:[Object(s.jsx)("h2",{children:e.room.name}),Object(s.jsx)("p",{children:n})]})]})}),E=(a(105),function(e){return Object(s.jsxs)("div",{className:"sidebar",children:[Object(s.jsxs)("div",{className:"sidebar_header",children:[Object(s.jsx)(M.a,{src:"https://avatars.githubusercontent.com/u/72368535?s=400&u=20eeecfe9dd1f5a481917319985b2de6d695a80c&v=4"}),Object(s.jsxs)("p",{children:[Object(s.jsx)("strong",{children:"Welcome:"})," ",Object(s.jsx)("br",{}),e.user]}),Object(s.jsxs)("div",{className:"sidebar_headerRight",children:[Object(s.jsx)(N.a,{children:Object(s.jsx)(g.a,{onClick:function(){return e.history.push("/")}})}),Object(s.jsx)(N.a,{children:Object(s.jsx)(O.a,{onClick:function(){return e.toggleChat()}})}),Object(s.jsx)(N.a,{children:Object(s.jsx)(p.a,{onClick:function(){return e.toggleSidebar()}})})]})]}),Object(s.jsx)("div",{className:"sidebar_search",children:Object(s.jsxs)("div",{className:"sidebar_searchContainer",children:[Object(s.jsx)(S.a,{}),Object(s.jsx)("input",{placeholder:"Search",type:"text"})]})}),Object(s.jsx)("div",{className:"sidebar_chats",children:e.chatRooms.map((function(t,a){return Object(s.jsx)(C,{roomName:e.roomName,room:t,lastMessage:e.lastMessage,handleClick:e.handleClick,toggleChat:e.toggleChat,toggleChatStatus:e.chatToggleStatus},a)}))})]})}),y=function(e){return Object(s.jsx)("div",{className:"skinnySidebar",children:Object(s.jsx)("div",{className:"skinnySidebar_headerRight",children:Object(s.jsx)(N.a,{children:Object(s.jsx)(p.a,{onClick:function(){return e.toggleSidebar()}})})})})},w=a(150),k=a(151),U=a(152),_=function(e){return Object(s.jsxs)("div",{className:"chat_header",children:[Object(s.jsx)(M.a,{}),Object(s.jsxs)("div",{className:"chat_headerInfo",children:[Object(s.jsx)("h3",{children:e.roomName}),Object(s.jsxs)("p",{children:["Last post was ",function(e){var t=Math.floor((new Date-e)/1e3),a=t/31536e3;return a>1?1===Math.floor(a)?Math.floor(a)+" year ago..":Math.floor(a)+" years ago..":(a=t/2592e3)>1?1===Math.floor(a)?Math.floor(a)+" month ago..":Math.floor(a)+" months ago..":(a=t/86400)>1?1===Math.floor(a)?Math.floor(a)+" day ago..":Math.floor(a)+" days ago..":(a=t/3600)>1?1===Math.floor(a)?Math.floor(a)+" hour ago..":Math.floor(a)+" hours ago..":(a=t/60)>1?1===Math.floor(a)?Math.floor(a)+" minute ago..":Math.floor(a)+" minutes ago..":" just now.."}(e.roomData.lastTimestamp)]})]}),Object(s.jsxs)("div",{className:"chat_headerRight",children:[Object(s.jsx)(N.a,{children:Object(s.jsx)(w.a,{})}),Object(s.jsx)(N.a,{children:Object(s.jsx)(k.a,{})}),Object(s.jsx)(N.a,{children:Object(s.jsx)(U.a,{onClick:function(){return e.handleToggleThread()}})})]})]})},I=a(68),T=a.n(I),F=function(e){return Object(s.jsx)("div",{children:Object(s.jsx)(T.a,{onEmojiClick:function(t,a){e.getEmoji(a),e.handleToggle()}})})},D=a(70),L=a.n(D),A=a(69),R=a(71),B=a.n(R),P=function(e){return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("p",{className:"chat_message ".concat(e.user===e.message.name?"chat_reciever":""),children:[Object(s.jsx)("span",{className:"chat_name",children:e.message.name}),e.message.message,Object(s.jsx)("span",{className:"chat_timestamp",children:function(e){var t=Math.floor((new Date-e)/1e3),a=t/31536e3;return a>1?1===Math.floor(a)?Math.floor(a)+" year ago..":Math.floor(a)+" years ago..":(a=t/2592e3)>1?1===Math.floor(a)?Math.floor(a)+" month ago..":Math.floor(a)+" months ago..":(a=t/86400)>1?1===Math.floor(a)?Math.floor(a)+" day ago..":Math.floor(a)+" days ago..":(a=t/3600)>1?1===Math.floor(a)?Math.floor(a)+" hour ago..":Math.floor(a)+" hours ago..":(a=t/60)>1?1===Math.floor(a)?Math.floor(a)+" minute ago..":Math.floor(a)+" minutes ago..":" just now.."}(e.message.timestamp)})]})})},W=function(e){var t=e.messages,a=Object(c.useState)(!1),n=Object(l.a)(a,2),o=n[0],r=n[1],i=Object(c.useState)(""),j=Object(l.a)(i,2),u=j[0],h=j[1],m=Object(c.useState)(e.latitude),g=Object(l.a)(m,2),f=g[0],O=g[1],x=Object(c.useState)(e.longitude),p=Object(l.a)(x,2),v=p[0],S=p[1],M=Object(c.useState)(!1),N=Object(l.a)(M,2),C=N[0],E=N[1];function y(e){O(e.coords.latitude),S(e.coords.longitude),E(!1)}function w(e){console.warn("Location not set"),d.a.get("https://extreme-ip-lookup.com/json/").then((function(e){O(e.data.lat),S(e.data.lon)})).catch(),E(!0)}Object(c.useEffect)((function(){k()}),[e.messages]),Object(c.useEffect)((function(){document.getElementById("test").focus(),navigator.geolocation.getCurrentPosition(y,w)}),[u]);var k=function(){A.animateScroll.scrollToBottom({containerId:"scroll"})},U=function(){!1===o?r(!0):!0===o&&r(!1)};return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("div",{className:"chat_body",id:"scroll",children:e.messages.map((function(a,c){return t[c].room===e.roomName?Object(s.jsx)(P,{message:a,user:e.user},c):null}))}),!0===C?Object(s.jsxs)("div",{className:"",children:[Object(s.jsx)("strong",{children:"Please turn on your location settings"})," ",Object(s.jsx)("br",{}),"(We are busy using an estimated location based on you IP Address)"]}):null,Object(s.jsxs)("div",{className:"chat_footer",children:[Object(s.jsx)(L.a,{onClick:U}),Object(s.jsxs)("form",{children:[Object(s.jsx)("input",{value:u,onChange:function(e){return h(e.target.value)},placeholder:"Type a message",type:"text",id:"test"}),Object(s.jsx)("button",{onClick:function(t){t.preventDefault(),b.post("/messages/new",{message:u,name:e.user,timestamp:Date.now(),room:e.roomName,latitude:f,longitude:v}).then((function(e){console.log("Message Succesfully sent"),h("")})).catch((function(e){return console.log("I am throwing and error:",e)}))},children:"Send a message"})]}),Object(s.jsx)(B.a,{})]}),!0===o?Object(s.jsx)(F,{getEmoji:function(e){h(u+e.emoji)},handleToggle:U}):null]})},G=function(e){var t=e.participant,a=Object(c.useState)(""),n=Object(l.a)(a,2),o=n[0],r=n[1];return Object(c.useEffect)((function(){t.lastMessage.length<=15?r(t.lastMessage):r(t.lastMessage.substring(0,20)+" ...")}),[t.lastMessage]),Object(s.jsxs)("div",{className:"sidebarChat",children:[Object(s.jsx)(M.a,{}),Object(s.jsxs)("div",{className:"sidebarChat_info",children:[Object(s.jsx)("h2",{children:t.name}),Object(s.jsx)("p",{children:o})]})]})},z=function(e){var t=Object(c.useState)([]),a=Object(l.a)(t,2),n=a[0],o=a[1];return Object(c.useEffect)((function(){b.get("room/".concat(e.roomName)).then((function(e){o(e.data.participants)})).catch((function(e){console.warn(e)}))}),[e.roomName]),Object(s.jsx)("div",{className:"chat_participants",children:n.map((function(e,t){return Object(s.jsx)(G,{participant:e},t)}))})},J=(a(114),function(e){var t=Object(c.useState)(!0),a=Object(l.a)(t,2),n=a[0],o=a[1],r=Object(c.useState)([]),i=Object(l.a)(r,2),j=i[0],u=i[1];Object(c.useEffect)((function(){b.get("room/".concat(e.roomName)).then((function(e){u(e.data)})).catch((function(e){console.warn(e)}))}),[e.messages]);return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(_,{handleToggleThread:function(){!1===n?o(!0):!0===n&&o(!1)},roomName:e.roomName,roomData:j,latitude:e.latitude,longitude:e.longitude}),!0===n?Object(s.jsx)(W,{messages:e.messages,roomName:e.roomName,user:e.user}):Object(s.jsx)(z,{roomName:e.roomName})]})}),K=a(41),Y=Object(K.GoogleApiWrapper)({apiKey:"AIzaSyAW5MNODxdAncbpnSGtOIl6Gyfjo-e6w3g"})((function(e){for(var t=Object(c.useState)(!1),a=Object(l.a)(t,2),n=a[0],o=a[1],r=Object(c.useState)(),i=Object(l.a)(r,2),j=i[0],u=i[1],h=Object(c.useState)({}),d=Object(l.a)(h,2),b=(d[0],d[1],new e.google.maps.LatLngBounds),m=0;m<e.points.length;m++)b.extend(e.points[m]);function g(e,t){for(var a="*",s="";e.length>t;){for(var c=!1,n=t-1;n>=0;n--)if(f(e.charAt(n))){s+=[e.slice(0,n),a].join(""),e=e.slice(n+1),c=!0;break}c||(s+=[e.slice(0,t),a].join(""),e=e.slice(t))}return s+e}function f(e){return new RegExp(/^\s$/).test(e.charAt(0))}Object(c.useEffect)((function(){u(b),o(!0)}),[]);var O={position:"absolute",width:!0===e.width?"58.5%":"85.3%",height:"89.5%"};return Object(s.jsx)("div",{children:e.points.length>0?Object(s.jsx)(K.Map,{google:e.google,zoom:15,style:O,initialCenter:{lat:e.latitude,lng:e.longitude},bounds:!0===n?b:j,children:!0===n?Object.values(e.sortedCoOrds).map((function(t,a){if(t.room===e.roomName)return Object(s.jsx)(K.Marker,{id:a,position:{lat:t.latitude,lng:t.longitude},onClick:function(){return console.log("You clicked me!")},title:g(t.msg,14).split("*")[0],icon:{url:"https://chart.googleapis.com/chart?chst=d_fnote&chld=thought|1|0088FF|h|".concat(g(t.msg,14).split("*")[0],"|").concat(void 0!==g(t.msg,14).split("*")[1]?g(t.msg,14).split("*")[1]:"","|").concat(void 0!==g(t.msg,14).split("*")[2]?g(t.msg,14).split("*")[2]:"")}},a)})):null}):Object(s.jsx)("p",{children:"Loading..."})})})),$=function(e){var t=Object(c.useState)([]),a=Object(l.a)(t,2),n=a[0],o=a[1],r=Object(c.useState)([]),j=Object(l.a)(r,2),h=j[0],m=j[1],g=Object(c.useState)(!1),f=Object(l.a)(g,2),O=f[0],x=f[1],p=Object(c.useState)(!0),v=Object(l.a)(p,2),S=v[0],M=v[1],N=Object(c.useState)(e.match.params.name),C=Object(l.a)(N,2),w=C[0],k=C[1],U=Object(c.useState)(e.match.params.user),_=Object(l.a)(U,1)[0],I=Object(c.useState)(""),T=Object(l.a)(I,2),F=T[0],D=T[1],L=Object(c.useState)(null),A=Object(l.a)(L,2),R=A[0],B=A[1],P=Object(c.useState)({}),W=Object(l.a)(P,1)[0],G=Object(c.useState)(0),z=Object(l.a)(G,2),K=z[0],$=z[1],q=Object(c.useState)(0),H=Object(l.a)(q,2),Q=H[0],V=H[1];Object(c.useEffect)((function(){b.get("/messages/sync/".concat(w)).then((function(e){o(e.data),e.data.forEach((function(e,t){W[e.name]={latitude:e.latitude,longitude:e.longitude,msg:e.message,room:w}}))})).catch((function(e){console.warn(e)})),d.a.get("https://extreme-ip-lookup.com/json/").then((function(e){$(e.data.lat),V(e.data.lon)})).catch()}),[]),Object(c.useEffect)((function(){b.get("/rooms/sync/".concat(_)).then((function(e){m(e.data)})).catch((function(e){console.warn(e)}))}),[e.match.params.name]),Object(c.useEffect)((function(){var e=new u.a("1bf1ac863ab88a3d0532",{cluster:"ap4"}).subscribe("messages");return e.bind("inserted",(function(e){o([].concat(Object(i.a)(n),[e])),D(e.message),n.forEach((function(e,t){W[e.name]={latitude:e.latitude,longitude:e.longitude,msg:e.message,room:w}}))})),function(){e.unbind_all(),e.unsubscribe()}}),[n]),Object(c.useEffect)((function(){var e=[];n.forEach((function(t,a){e.push({lat:t.latitude,lng:t.longitude})})),B(e)}),[n]);var X=function(){!1===S?M(!0):!0===S&&(M(!1),x(!1))};return Object(s.jsx)("div",{className:"app",children:Object(s.jsxs)("div",{className:"app_body",children:[!0===S?Object(s.jsx)(E,{toggleChat:function(){!1===O?x(!0):!0===O&&x(!1)},chatToggleStatus:O,toggleSidebar:X,chatRooms:h,handleClick:function(t){b.post("/user/".concat(_,"/room/").concat(t)).then((function(e){})).catch((function(e){console.warn(e)})),b.get("/messages/sync/".concat(t)).then((function(e){o(e.data),e.data.forEach((function(e,a){W[e.name]={latitude:e.latitude,longitude:e.longitude,msg:e.message,room:t}}))})).catch((function(e){console.warn(e)})),k(t),e.history.push("/room/".concat(t,"/").concat(_))},lastMessage:F,roomName:w,user:_,history:e.history}):Object(s.jsx)(y,{toggleSidebar:X}),Object(s.jsx)("div",{className:"chat",children:!0===O?Object(s.jsx)(J,{messages:n,roomName:w,user:_,rooms:h,lastMessage:F,latitude:K,longitude:Q}):null!==R?Object(s.jsx)(Y,{width:S,messages:n,points:R,sortedCoOrds:W,roomName:w,latitude:K,longitude:Q}):Object(s.jsx)("p",{children:"Loading..."})})]})})},q=(a(130),function(e){var t=Object(c.useState)([]),a=Object(l.a)(t,2),n=(a[0],a[1]),o=Object(c.useState)(!1),r=Object(l.a)(o,2),i=r[0],j=r[1];Object(c.useEffect)((function(){b.get("/users").then((function(e){n(e.data)})).catch((function(e){console.warn(e)}))}),[]);return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("div",{className:"dropdown",children:[Object(s.jsx)("button",{onClick:function(){!0===i?j(!1):!1===i&&j(!0)},className:"dropbtn",children:"Select User"}),!0===i?Object(s.jsxs)("div",{id:"myDropdown",className:"dropdown-content",children:[Object(s.jsx)("a",{href:"#/room/SEI40/User1",children:"User1"}),Object(s.jsx)("a",{href:"#/room/SEI40/User2",children:"User2"}),Object(s.jsx)("a",{href:"#/room/SEI40/User3",children:"User3"}),Object(s.jsx)("a",{href:"#/room/SEI40/User4",children:"User4"}),Object(s.jsx)("a",{href:"#/room/SEI40/User5",children:"User5"}),Object(s.jsx)("a",{href:"#/room/SEI40/User6",children:"User6"}),Object(s.jsx)("a",{href:"#/room/SEI40/User7",children:"User7"}),Object(s.jsx)("a",{href:"#/room/SEI40/User8",children:"User8"}),Object(s.jsx)("a",{href:"#/room/SEI40/User9",children:"User9"}),Object(s.jsx)("a",{href:"#/room/SEI40/User10",children:"User10"}),Object(s.jsx)("a",{href:"#/room/SEI40/User11",children:"User11"})]}):null]})})}),H=a(72),Q=a(6),V=function(){return Object(s.jsx)("div",{className:"app",children:Object(s.jsxs)(H.a,{children:[Object(s.jsx)(Q.a,{exact:!0,path:"/",component:q}),Object(s.jsx)(Q.a,{exact:!0,path:"/user/:user",component:$}),Object(s.jsx)(Q.a,{exact:!0,path:"/room/:name/:user",component:$})]})})},X=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,155)).then((function(t){var a=t.getCLS,s=t.getFID,c=t.getFCP,n=t.getLCP,o=t.getTTFB;a(e),s(e),c(e),n(e),o(e)}))};r.a.render(Object(s.jsx)(n.a.StrictMode,{children:Object(s.jsx)(V,{})}),document.getElementById("root")),X()},80:function(e,t,a){},99:function(e,t,a){}},[[134,1,2]]]);
//# sourceMappingURL=main.915fee2f.chunk.js.map