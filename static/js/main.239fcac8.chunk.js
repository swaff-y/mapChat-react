(this["webpackJsonpmap-chatr"]=this["webpackJsonpmap-chatr"]||[]).push([[0],{100:function(e,t,a){},105:function(e,t,a){},114:function(e,t,a){},130:function(e,t,a){},134:function(e,t,a){"use strict";a.r(t);var s,o=a(1),c=a(0),n=a.n(c),r=a(14),i=a.n(r),l=(a(80),a(19)),j=a(3),u=a(64),h=a.n(u),d=a(26),m=a.n(d);s="https://swaff-y.github.io/";var b=m.a.create({baseURL:s}),g=(a(99),a(65)),f=a.n(g),O=a(66),x=a.n(O),p=a(40),v=a.n(p),M=a(67),S=a.n(M),N=a(154),C=a(153),w=(a(100),function(e){var t=Object(c.useState)(""),a=Object(j.a)(t,2),s=a[0],n=a[1];Object(c.useEffect)((function(){e.room.lastMessage.length<=15?n(e.room.lastMessage):n(e.room.lastMessage.substring(0,20)+" ...")}),[e.room.lastMessage]),Object(c.useEffect)((function(){e.roomName===e.room.name&&""!==e.lastMessage&&(e.lastMessage.length<=15?n(e.lastMessage):n(e.lastMessage.substring(0,20)+"..."))}),[e.lastMessage]);return Object(o.jsxs)("div",{className:"sidebarChat",onClick:function(){e.handleClick(e.room.name),!0!==e.toggleChatStatus&&e.toggleChat()},children:[Object(o.jsx)(N.a,{}),Object(o.jsxs)("div",{className:"sidebarChat_info",children:[Object(o.jsx)("h2",{children:e.room.name}),Object(o.jsx)("p",{children:s})]})]})}),E=(a(105),function(e){var t=Object(c.useState)(""),a=Object(j.a)(t,2),s=a[0],n=a[1],r=Object(c.useState)(null),i=Object(j.a)(r,2),l=i[0],u=i[1];e.chatRooms.forEach((function(e){}));return Object(o.jsxs)("div",{className:"sidebar",children:[Object(o.jsxs)("div",{className:"sidebar_header",children:[Object(o.jsx)(N.a,{src:"https://avatars.githubusercontent.com/u/72368535?s=400&u=20eeecfe9dd1f5a481917319985b2de6d695a80c&v=4"}),Object(o.jsxs)("p",{children:[Object(o.jsx)("strong",{children:"Welcome:"})," ",Object(o.jsx)("br",{}),e.user]}),Object(o.jsxs)("div",{className:"sidebar_headerRight",children:[Object(o.jsx)(C.a,{children:Object(o.jsx)(f.a,{onClick:function(){return e.history.push("/")}})}),Object(o.jsx)(C.a,{children:Object(o.jsx)(x.a,{onClick:function(){return e.toggleChat()}})}),Object(o.jsx)(C.a,{children:Object(o.jsx)(v.a,{onClick:function(){return e.toggleSidebar()}})})]})]}),Object(o.jsx)("div",{className:"sidebar_search",children:Object(o.jsxs)("div",{className:"sidebar_searchContainer",children:[Object(o.jsx)(S.a,{}),Object(o.jsxs)("form",{children:[Object(o.jsx)("input",{placeholder:"Search",type:"text",onChange:function(t){var a=t.target.value;console.log(a),n(a);var s=t.target.value.length-1;console.log(a,s,l);var o=[];null===l?e.chatRooms.forEach((function(e){console.log("room index:",s);var t={};s>=0&&(console.log("here"),a.toLowerCase()===e.name[s].toLowerCase()&&(t.name=e.name,t.lastMessage=e.lastMessage,o.push(t)))})):l.forEach((function(e){var t={};s>=0&&s<1?a.toLowerCase()===e.name[s].toLowerCase()&&(t.name=e.name,t.lastMessage=e.lastMessage,o.push(t)):1===s?a[s].toLowerCase()===e.name[s].toLowerCase()&&(t.name=e.name,t.lastMessage=e.lastMessage,o.push(t)):2===s&&a[s].toLowerCase()===e.name[s].toLowerCase()&&(t.name=e.name,t.lastMessage=e.lastMessage,o.push(t))})),u(s<0?e.chatRooms:o)}}),Object(o.jsx)("input",{type:"submit",className:"hide",onClick:function(){console.log("This is the text: ",s)}})]})]})}),Object(o.jsx)("div",{className:"sidebar_chats",children:null!==l?l.map((function(t,a){return Object(o.jsx)(w,{roomName:e.roomName,room:t,lastMessage:e.lastMessage,handleClick:e.handleClick,toggleChat:e.toggleChat,toggleChatStatus:e.chatToggleStatus},a)})):e.chatRooms.map((function(t,a){return Object(o.jsx)(w,{roomName:e.roomName,room:t,lastMessage:e.lastMessage,handleClick:e.handleClick,toggleChat:e.toggleChat,toggleChatStatus:e.chatToggleStatus},a)}))})]})}),y=function(e){return Object(o.jsx)("div",{className:"skinnySidebar",children:Object(o.jsx)("div",{className:"skinnySidebar_headerRight",children:Object(o.jsx)(C.a,{children:Object(o.jsx)(v.a,{onClick:function(){return e.toggleSidebar()}})})})})},k=a(150),U=a(151),_=a(152),I=function(e){return Object(o.jsxs)("div",{className:"chat_header",children:[Object(o.jsx)(N.a,{}),Object(o.jsxs)("div",{className:"chat_headerInfo",children:[Object(o.jsx)("h3",{children:e.roomName}),Object(o.jsxs)("p",{children:["Last post was ",function(e){var t=Math.floor((new Date-e)/1e3),a=t/31536e3;return a>1?1===Math.floor(a)?Math.floor(a)+" year ago..":Math.floor(a)+" years ago..":(a=t/2592e3)>1?1===Math.floor(a)?Math.floor(a)+" month ago..":Math.floor(a)+" months ago..":(a=t/86400)>1?1===Math.floor(a)?Math.floor(a)+" day ago..":Math.floor(a)+" days ago..":(a=t/3600)>1?1===Math.floor(a)?Math.floor(a)+" hour ago..":Math.floor(a)+" hours ago..":(a=t/60)>1?1===Math.floor(a)?Math.floor(a)+" minute ago..":Math.floor(a)+" minutes ago..":" just now.."}(e.roomData.lastTimestamp)]})]}),Object(o.jsxs)("div",{className:"chat_headerRight",children:[Object(o.jsx)(C.a,{children:Object(o.jsx)(k.a,{})}),Object(o.jsx)(C.a,{children:Object(o.jsx)(U.a,{})}),Object(o.jsx)(C.a,{children:Object(o.jsx)(_.a,{onClick:function(){return e.handleToggleThread()}})})]})]})},L=a(68),T=a.n(L),F=function(e){return Object(o.jsx)("div",{children:Object(o.jsx)(T.a,{onEmojiClick:function(t,a){e.getEmoji(a),e.handleToggle()}})})},R=a(70),D=a.n(R),A=a(69),B=a(71),P=a.n(B),W=function(e){return Object(o.jsx)(o.Fragment,{children:Object(o.jsxs)("p",{className:"chat_message ".concat(e.user===e.message.name?"chat_reciever":""),children:[Object(o.jsx)("span",{className:"chat_name",children:e.message.name}),e.message.message,Object(o.jsx)("span",{className:"chat_timestamp",children:function(e){var t=Math.floor((new Date-e)/1e3),a=t/31536e3;return a>1?1===Math.floor(a)?Math.floor(a)+" year ago..":Math.floor(a)+" years ago..":(a=t/2592e3)>1?1===Math.floor(a)?Math.floor(a)+" month ago..":Math.floor(a)+" months ago..":(a=t/86400)>1?1===Math.floor(a)?Math.floor(a)+" day ago..":Math.floor(a)+" days ago..":(a=t/3600)>1?1===Math.floor(a)?Math.floor(a)+" hour ago..":Math.floor(a)+" hours ago..":(a=t/60)>1?1===Math.floor(a)?Math.floor(a)+" minute ago..":Math.floor(a)+" minutes ago..":" just now.."}(e.message.timestamp)})]})})},G=function(e){var t=e.messages,a=Object(c.useState)(!1),s=Object(j.a)(a,2),n=s[0],r=s[1],i=Object(c.useState)(""),l=Object(j.a)(i,2),u=l[0],h=l[1],d=Object(c.useState)(e.latitude),g=Object(j.a)(d,2),f=g[0],O=g[1],x=Object(c.useState)(e.longitude),p=Object(j.a)(x,2),v=p[0],M=p[1],S=Object(c.useState)(!1),N=Object(j.a)(S,2),C=N[0],w=N[1];function E(e){O(e.coords.latitude),M(e.coords.longitude),w(!1)}function y(e){console.warn("Location not set"),m.a.get("https://extreme-ip-lookup.com/json/").then((function(e){O(e.data.lat),M(e.data.lon)})).catch(),w(!0)}Object(c.useEffect)((function(){k()}),[e.messages]),Object(c.useEffect)((function(){document.getElementById("test").focus(),navigator.geolocation.getCurrentPosition(E,y)}),[u]);var k=function(){A.animateScroll.scrollToBottom({containerId:"scroll"})},U=function(){!1===n?r(!0):!0===n&&r(!1)};return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)("div",{className:"chat_body",id:"scroll",children:e.messages.map((function(a,s){return t[s].room===e.roomName?Object(o.jsx)(W,{message:a,user:e.user},s):null}))}),!0===C?Object(o.jsxs)("div",{className:"",children:[Object(o.jsx)("strong",{children:"Please turn on your location settings"})," ",Object(o.jsx)("br",{}),"(We are busy using an estimated location based on you IP Address)"]}):null,Object(o.jsxs)("div",{className:"chat_footer",children:[Object(o.jsx)(D.a,{onClick:U}),Object(o.jsxs)("form",{children:[Object(o.jsx)("input",{value:u,onChange:function(e){return h(e.target.value)},placeholder:"Type a message",type:"text",id:"test"}),Object(o.jsx)("button",{onClick:function(t){t.preventDefault(),b.post("/messages/new",{message:u,name:e.user,timestamp:Date.now(),room:e.roomName,latitude:f,longitude:v}).then((function(e){console.log("Message Succesfully sent"),h("")})).catch((function(e){return console.log("I am throwing and error:",e)}))},children:"Send a message"})]}),Object(o.jsx)(P.a,{})]}),!0===n?Object(o.jsx)(F,{getEmoji:function(e){h(u+e.emoji)},handleToggle:U}):null]})},z=function(e){var t=e.participant,a=Object(c.useState)(""),s=Object(j.a)(a,2),n=s[0],r=s[1];return Object(c.useEffect)((function(){t.lastMessage.length<=15?r(t.lastMessage):r(t.lastMessage.substring(0,20)+" ...")}),[t.lastMessage]),Object(o.jsxs)("div",{className:"sidebarChat",children:[Object(o.jsx)(N.a,{}),Object(o.jsxs)("div",{className:"sidebarChat_info",children:[Object(o.jsx)("h2",{children:t.name}),Object(o.jsx)("p",{children:n})]})]})},J=function(e){var t=Object(c.useState)([]),a=Object(j.a)(t,2),s=a[0],n=a[1];return Object(c.useEffect)((function(){b.get("room/".concat(e.roomName)).then((function(e){n(e.data.participants)})).catch((function(e){console.warn(e)}))}),[e.roomName]),Object(o.jsx)("div",{className:"chat_participants",children:s.map((function(e,t){return Object(o.jsx)(z,{participant:e},t)}))})},K=(a(114),function(e){var t=Object(c.useState)(!0),a=Object(j.a)(t,2),s=a[0],n=a[1],r=Object(c.useState)([]),i=Object(j.a)(r,2),l=i[0],u=i[1];Object(c.useEffect)((function(){b.get("room/".concat(e.roomName)).then((function(e){u(e.data)})).catch((function(e){console.warn(e)}))}),[e.messages]);return Object(o.jsxs)(o.Fragment,{children:[Object(o.jsx)(I,{handleToggleThread:function(){!1===s?n(!0):!0===s&&n(!1)},roomName:e.roomName,roomData:l,latitude:e.latitude,longitude:e.longitude}),!0===s?Object(o.jsx)(G,{messages:e.messages,roomName:e.roomName,user:e.user}):Object(o.jsx)(J,{roomName:e.roomName})]})}),Y=a(41),$=Object(Y.GoogleApiWrapper)({apiKey:"AIzaSyAW5MNODxdAncbpnSGtOIl6Gyfjo-e6w3g"})((function(e){for(var t=Object(c.useState)(!1),a=Object(j.a)(t,2),s=a[0],n=a[1],r=Object(c.useState)(),i=Object(j.a)(r,2),l=i[0],u=i[1],h=Object(c.useState)({}),d=Object(j.a)(h,2),m=(d[0],d[1],new e.google.maps.LatLngBounds),b=0;b<e.points.length;b++)m.extend(e.points[b]);function g(e,t){for(var a="*",s="";e.length>t;){for(var o=!1,c=t-1;c>=0;c--)if(f(e.charAt(c))){s+=[e.slice(0,c),a].join(""),e=e.slice(c+1),o=!0;break}o||(s+=[e.slice(0,t),a].join(""),e=e.slice(t))}return s+e}function f(e){return new RegExp(/^\s$/).test(e.charAt(0))}Object(c.useEffect)((function(){u(m),n(!0)}),[]);var O={position:"absolute",width:!0===e.width?"58.5%":"85.3%",height:"89.5%"};return Object(o.jsx)("div",{children:e.points.length>0?Object(o.jsx)(Y.Map,{google:e.google,zoom:15,style:O,initialCenter:{lat:e.latitude,lng:e.longitude},bounds:!0===s?m:l,children:!0===s?Object.values(e.sortedCoOrds).map((function(t,a){if(t.room===e.roomName)return Object(o.jsx)(Y.Marker,{id:a,position:{lat:t.latitude,lng:t.longitude},onClick:function(){return console.log("You clicked me!")},title:g(t.msg,14).split("*")[0],icon:{url:"https://chart.googleapis.com/chart?chst=d_fnote&chld=thought|1|0088FF|h|".concat(g(t.msg,14).split("*")[0],"|").concat(void 0!==g(t.msg,14).split("*")[1]?g(t.msg,14).split("*")[1]:"","|").concat(void 0!==g(t.msg,14).split("*")[2]?g(t.msg,14).split("*")[2]:"")}},a)})):null}):Object(o.jsx)("p",{children:"Loading..."})})})),q=function(e){var t=Object(c.useState)([]),a=Object(j.a)(t,2),s=a[0],n=a[1],r=Object(c.useState)([]),i=Object(j.a)(r,2),u=i[0],d=i[1],g=Object(c.useState)(!1),f=Object(j.a)(g,2),O=f[0],x=f[1],p=Object(c.useState)(!0),v=Object(j.a)(p,2),M=v[0],S=v[1],N=Object(c.useState)(e.match.params.name),C=Object(j.a)(N,2),w=C[0],k=C[1],U=Object(c.useState)(e.match.params.user),_=Object(j.a)(U,1)[0],I=Object(c.useState)(""),L=Object(j.a)(I,2),T=L[0],F=L[1],R=Object(c.useState)(null),D=Object(j.a)(R,2),A=D[0],B=D[1],P=Object(c.useState)({}),W=Object(j.a)(P,1)[0],G=Object(c.useState)(0),z=Object(j.a)(G,2),J=z[0],Y=z[1],q=Object(c.useState)(0),H=Object(j.a)(q,2),Q=H[0],V=H[1];Object(c.useEffect)((function(){b.get("/messages/sync/".concat(w)).then((function(e){n(e.data),e.data.forEach((function(e,t){W[e.name]={latitude:e.latitude,longitude:e.longitude,msg:e.message,room:w}}))})).catch((function(e){console.warn(e)})),m.a.get("https://extreme-ip-lookup.com/json/").then((function(e){Y(e.data.lat),V(e.data.lon)})).catch()}),[]),Object(c.useEffect)((function(){b.get("/rooms/sync/".concat(_)).then((function(e){d(e.data)})).catch((function(e){console.warn(e)}))}),[e.match.params.name]),Object(c.useEffect)((function(){var e=new h.a("1bf1ac863ab88a3d0532",{cluster:"ap4"}).subscribe("messages");return e.bind("inserted",(function(e){n([].concat(Object(l.a)(s),[e])),F(e.message),s.forEach((function(e,t){W[e.name]={latitude:e.latitude,longitude:e.longitude,msg:e.message,room:w}}))})),function(){e.unbind_all(),e.unsubscribe()}}),[s]),Object(c.useEffect)((function(){var e=[];s.forEach((function(t,a){e.push({lat:t.latitude,lng:t.longitude})})),B(e)}),[s]);var X=function(){!1===M?S(!0):!0===M&&(S(!1),x(!1))};return Object(o.jsx)("div",{className:"app",children:Object(o.jsxs)("div",{className:"app_body",children:[!0===M?Object(o.jsx)(E,{toggleChat:function(){!1===O?x(!0):!0===O&&x(!1)},chatToggleStatus:O,toggleSidebar:X,chatRooms:u,handleClick:function(t){b.post("/user/".concat(_,"/room/").concat(t)).then((function(e){})).catch((function(e){console.warn(e)})),b.get("/messages/sync/".concat(t)).then((function(e){n(e.data),e.data.forEach((function(e,a){W[e.name]={latitude:e.latitude,longitude:e.longitude,msg:e.message,room:t}}))})).catch((function(e){console.warn(e)})),k(t),e.history.push("/room/".concat(t,"/").concat(_))},lastMessage:T,roomName:w,user:_,history:e.history}):Object(o.jsx)(y,{toggleSidebar:X}),Object(o.jsx)("div",{className:"chat",children:!0===O?Object(o.jsx)(K,{messages:s,roomName:w,user:_,rooms:u,lastMessage:T,latitude:J,longitude:Q}):null!==A?Object(o.jsx)($,{width:M,messages:s,points:A,sortedCoOrds:W,roomName:w,latitude:J,longitude:Q}):Object(o.jsx)("p",{children:"Loading..."})})]})})},H=(a(130),function(e){var t=Object(c.useState)([]),a=Object(j.a)(t,2),s=(a[0],a[1]),n=Object(c.useState)(!1),r=Object(j.a)(n,2),i=r[0],l=r[1];Object(c.useEffect)((function(){b.get("/users").then((function(e){s(e.data)})).catch((function(e){console.warn(e)}))}),[]);return Object(o.jsx)(o.Fragment,{children:Object(o.jsxs)("div",{className:"dropdown",children:[Object(o.jsx)("button",{onClick:function(){!0===i?l(!1):!1===i&&l(!0)},className:"dropbtn",children:"Select User"}),!0===i?Object(o.jsxs)("div",{id:"myDropdown",className:"dropdown-content",children:[Object(o.jsx)("a",{href:"#/room/SEI40/User1",children:"User1"}),Object(o.jsx)("a",{href:"#/room/SEI40/User2",children:"User2"}),Object(o.jsx)("a",{href:"#/room/SEI40/User3",children:"User3"}),Object(o.jsx)("a",{href:"#/room/SEI40/User4",children:"User4"}),Object(o.jsx)("a",{href:"#/room/SEI40/User5",children:"User5"}),Object(o.jsx)("a",{href:"#/room/SEI40/User6",children:"User6"}),Object(o.jsx)("a",{href:"#/room/SEI40/User7",children:"User7"}),Object(o.jsx)("a",{href:"#/room/SEI40/User8",children:"User8"}),Object(o.jsx)("a",{href:"#/room/SEI40/User9",children:"User9"}),Object(o.jsx)("a",{href:"#/room/SEI40/User10",children:"User10"}),Object(o.jsx)("a",{href:"#/room/SEI40/User11",children:"User11"})]}):null]})})}),Q=a(72),V=a(6),X=function(){return Object(o.jsx)("div",{className:"app",children:Object(o.jsxs)(Q.a,{children:[Object(o.jsx)(V.a,{exact:!0,path:"/",component:H}),Object(o.jsx)(V.a,{exact:!0,path:"/user/:user",component:q}),Object(o.jsx)(V.a,{exact:!0,path:"/room/:name/:user",component:q})]})})},Z=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,155)).then((function(t){var a=t.getCLS,s=t.getFID,o=t.getFCP,c=t.getLCP,n=t.getTTFB;a(e),s(e),o(e),c(e),n(e)}))};i.a.render(Object(o.jsx)(n.a.StrictMode,{children:Object(o.jsx)(X,{})}),document.getElementById("root")),Z()},80:function(e,t,a){},99:function(e,t,a){}},[[134,1,2]]]);
//# sourceMappingURL=main.239fcac8.chunk.js.map